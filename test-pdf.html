<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Preview Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      button {
        background-color: #2563eb;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      button:hover {
        background-color: #1d4ed8;
      }
      .info {
        background-color: #f3f4f6;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .header-list {
        margin: 10px 0;
      }
      .header-list li {
        margin: 5px 0;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>PDF Table Headers Test</h1>

    <div class="info">
      <h3>What the table headers should show:</h3>
      <ul class="header-list">
        <li>Item No. - Sequential number (1, 2, 3...)</li>
        <li>Item Description - Product name</li>
        <li>Qty - Quantity ordered</li>
        <li>Unit Pack - Unit of measurement (Piece, Box, etc.)</li>
        <li>Unit Price (incl) Ksh - Price per unit including tax</li>
        <li>Vat - VAT percentage (16%, etc.)</li>
        <li>Total Price (incl) Ksh - Line total amount</li>
      </ul>

      <p>
        <strong>Header Color:</strong> Blue (#2563eb) background with white text
      </p>
      <p>
        <strong>Previous Issue:</strong> Headers were using black background
        which made them invisible
      </p>
      <p>
        <strong>Current Fix:</strong> Now using company primary color (blue) for
        better visibility
      </p>
    </div>

    <button onclick="generateTestPDF()">Generate Test PDF</button>

    <script>
      function hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result
          ? [
              parseInt(result[1], 16),
              parseInt(result[2], 16),
              parseInt(result[3], 16),
            ]
          : [0, 0, 0];
      }

      function generateTestPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Sample data
        const tableData = [
          [
            1,
            "Medical Syringes 10ml",
            100,
            "Piece",
            "25.00",
            "16%",
            "2,900.00",
          ],
          [2, "Surgical Gloves Size M", 50, "Box", "150.00", "16%", "8,700.00"],
          [3, "Digital Thermometer", 25, "Piece", "320.00", "16%", "9,280.00"],
        ];

        // Company header
        doc.setFontSize(18);
        doc.setFont("helvetica", "bold");
        doc.text("MEDPLUS AFRICA LIMITED", 105, 25, { align: "center" });

        doc.setFontSize(14);
        doc.text("SAMPLE INVOICE - PDF HEADER TEST", 105, 40, {
          align: "center",
        });

        // Table with proper headers and styling
        const primaryColor = "#2563eb";
        const headerColor = hexToRgb(primaryColor);

        doc.autoTable({
          startY: 60,
          head: [
            [
              "Item\nNo.",
              "Item Description",
              "Qty",
              "Unit\nPack",
              "Unit Price\n(incl) Ksh",
              "Vat",
              "Total Price\n(incl) Ksh",
            ],
          ],
          body: tableData,
          theme: "grid",
          styles: {
            fontSize: 9,
            cellPadding: 4,
            lineColor: [44, 62, 80],
            lineWidth: 0.5,
          },
          headStyles: {
            fillColor: headerColor,
            textColor: [255, 255, 255],
            fontStyle: "bold",
            fontSize: 8,
            halign: "center",
            valign: "middle",
            minCellHeight: 18,
            lineColor: [0, 0, 0],
            lineWidth: 0.3,
          },
          columnStyles: {
            0: { halign: "center", cellWidth: 15 },
            1: { halign: "left", cellWidth: 60 },
            2: { halign: "center", cellWidth: 15 },
            3: { halign: "center", cellWidth: 20 },
            4: { halign: "right", cellWidth: 25 },
            5: { halign: "center", cellWidth: 15 },
            6: { halign: "right", cellWidth: 30 },
          },
        });

        // Total section
        const finalY = doc.lastAutoTable.finalY + 20;
        doc.setDrawColor(0, 0, 0);
        doc.setLineWidth(0.3);
        doc.rect(125, finalY - 5, 70, 15);
        doc.setFillColor(248, 249, 250);
        doc.rect(125, finalY - 5, 70, 15, "F");
        doc.rect(125, finalY - 5, 70, 15);

        doc.setTextColor(0, 0, 0);
        doc.setFontSize(10);
        doc.setFont("helvetica", "bold");
        doc.text("Total Amount Inc. VAT (Kes)", 128, finalY + 5);
        doc.text("20,880.00", 192, finalY + 5, { align: "right" });

        // Save the PDF
        doc.save("header-test.pdf");
      }
    </script>
  </body>
</html>
